!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Apm=t():(e.FreedomPay=e.FreedomPay||{},e.FreedomPay.Apm=t())}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=function(){function e(){}return e.addEventListenerToTop=function(e,t){this.removeEventListenerFromTop(e,t),window.top.document.addEventListener(e,t,!1)},e.bindEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},e.bindMessageEvent=function(e,t){this.bindEvent(e,"message",t)},e.createElement=function(e){return this.getDocument().createElement(e)},e.dispatchEventToTop=function(e){window.top.document.dispatchEvent(e)},e.getAppVersion=function(){var e=this.getElementsByTagName("html")[0];return e?e.getAttribute("app-version"):""},e.getDocument=function(){return window.document},e.getElementsByClass=function(e){return this.getDocument().getElementsByClassName(e)},e.getElementById=function(e){return this.getDocument().getElementById(e)},e.getElementsByTagName=function(e,t){return void 0===t&&(t=null),null===t&&(t=this.getDocument()),t.getElementsByTagName(e)},e.getHost=function(){return this.getHostAnchor().host},e.getHostOrigin=function(){var e=this.getHostAnchor(),t=e.origin?e.origin:e.protocol+"//"+e.host;return t===window.location.origin&&o.Utilities.isNullOrEmpty(this.getReferrer())&&(t="*"),t},e.getQueryString=function(e){return"?"+Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")},e.getSessionKeyFromUrl=function(t){return void 0===t&&(t=null),e.getUrlParameter("sessionKey",t)},e.getUrlParameter=function(e,t){void 0===t&&(t=null),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=t;null==t&&(n=window.location.search);var o=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(n);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))},e.logDebugMessageToConsole=function(e){window.console&&this.isDebug()&&window.console.log(e)},e.logToConsole=function(e){window.console&&window.console.log(e)},e.removeEventListener=function(e,t){e.removeEventListener("message",t)},e.removeEventListenerFromTop=function(e,t){window.top.document.removeEventListener(e,t,!1)},e.sendHostMessage=function(t,n){var o=n?n.hostOrigin:e.getHostOrigin();window.parent.postMessage(t,o)},e.sendPostMessageToTop=function(t,n){var i=e.getHostOrigin();o.Utilities.isNullOrUndefined(n)||o.Utilities.isNullOrEmpty(n.hostOrigin)||(i=n.hostOrigin),this.logDebugMessageToConsole("sendPostMessageToTop"),this.logDebugMessageToConsole(t),window.top.postMessage(t,i)},e.sendPostMessageToIframe=function(e,t){var n=t.href;this.logDebugMessageToConsole("sendPostMessageToIframe for "+n),this.logDebugMessageToConsole(e),this.logDebugMessageToConsole(t);var i=this.findIframeBySourceUrl(n,this.getDocument());o.Utilities.isNullOrUndefined(i)&&this.logToConsole("Could not find iframe for "+n),i.contentWindow.postMessage(e,t.host)},e.findIframeBySourceUrl=function(e,t){var n=null;if(null!==t)for(var o=t.getElementsByTagName("iframe"),i=o.length,r=0;r<i;r++){var s=o[r];if(s.src===e){n=s;break}if(null!==(n=this.findIframeBySourceUrl(e,s.contentDocument)))return n}return n},e.getReferrer=function(){var e=window.settings;return e&&!o.Utilities.isNullOrEmpty(e.Referrer)?e.Referrer:this.getDocument().referrer},e.getHostAnchor=function(){var e=this.createElement("a");return e.href=this.getReferrer(),e},e.isDebug=function(e){return void 0===e&&(e=window.location.href),this.debugHostOriginRegex.test(e)},e.debugHostOriginRegex=/(hpc(\S+|\.)(qa|dev|uat)\.freedompay\.com)|localhost\:\d+|(freedompay\.championsdev\.com)|(test1\.readydemo\.co)/,e}();t.WindowHelper=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){this.type=e,this.data=t,this.messageCode=n};t.Message=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.ReceiveErrors=1]="ReceiveErrors",e[e.ReceiveFrameHeight=2]="ReceiveFrameHeight",e[e.ReceivePaymentKey=3]="ReceivePaymentKey",e[e.ReceiveValidityChange=4]="ReceiveValidityChange",e[e.SendApplePayIsSupported=5]="SendApplePayIsSupported",e[e.ReceiveApplePayIsSupported=6]="ReceiveApplePayIsSupported",e[e.SendApplePayClick=8]="SendApplePayClick",e[e.SendSetupApplePayHelper=9]="SendSetupApplePayHelper",e[e.SendSetupCardinalHelper=10]="SendSetupCardinalHelper",e[e.SendInvokeCardinal=11]="SendInvokeCardinal",e[e.SendCardinalApprove=12]="SendCardinalApprove",e[e.SendSetCardinalSessionId=13]="SendSetCardinalSessionId",e[e.SendCardinalErrors=14]="SendCardinalErrors",e[e.ReceiveLegalClick=15]="ReceiveLegalClick",e[e.ReceiveConsumerAuthData=16]="ReceiveConsumerAuthData",e[e.InvokeConsumerAuth=17]="InvokeConsumerAuth"}(t.EventType||(t.EventType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),i=n(7),r=n(6),s=n(0),a=function(){function e(){}return e.isNullOrUndefined=function(e){return null==e},e.isNullOrEmpty=function(e){return!!this.isNullOrUndefined(e)||0===e.length},e.getCardinalCentinelSessionIdElement=function(){return s.WindowHelper.getElementById(r.Constants.cardinalSessionIdElementId)},e.poll=function(e){var t=e.validate,n=e.interval,i=e.maxAttempts,r=0,s=function(e,o){return r++,t()?e():i&&r===i?o(new Error("Exceeded max attempts")):void setTimeout(s,n,e,o)};return new o(s)},e.getElementBySelector=function(e,t){void 0===t&&(t=!1);var n=document.querySelector(e);if(this.isNullOrUndefined(n)&&t)throw this.formatString(i.Messages.elementNotFound,e);return n},e.getBodyElement=function(){return window.document.getElementsByTagName("body")[0]},e.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,(function(e,n){return t[n]||""}))},e.validateCardNumber=function(e){if(/[^0-9-\s]+/.test(e))return!1;for(var t,n=0,o=!1,i=(e=e.replace(/\D/g,"")).length-1;i>=0;i--){var r=e.charAt(i);t=parseInt(r,10),o&&(t*=2)>9&&(t-=9),n+=t,o=!o}return n%10==0},e.setElementValue=function(e,t){var n=s.WindowHelper.getElementById(e);if(this.isNullOrUndefined(n))throw"Element with ID "+e+" was not found";n.value=t},e.isCardinalSetup=function(){var e=this.getCardinalCentinelSessionIdElement();return!this.isNullOrUndefined(e)&&!this.isNullOrEmpty(e.value)},e.isFunction=function(e){return!this.isNullOrUndefined(e)&&"function"==typeof e},e.hasDisabledClass=function(e){return e.className.indexOf(r.Constants.disabledClassName)>-1},e}();t.Utilities=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(11),i=function(e,t,n,i,r){void 0===i&&(i=o.ErrorType.Error),void 0===r&&(r=null),this.emittedBy=e,this.message=t,this.messageCode=n,this.errorType=i,this.data=r};t.Error=i},function(e,t,n){(function(t){!function(){"use strict";var n,o,i="object"==typeof self,r=i?self:t,s=r.Promise,a=r.process,u=Array,l={e:null},d=function(){},c=r.Symbol||{},p=i?function(e){s?new s((function(e){e()})).then(e):setTimeout(e)}:a.nextTick,f=function(e){var t;if(!y(this)||void 0!==this._s)throw b("Invalid this");if(this._s=2,e!==d){if(!g(e))throw b("Invalid argument");(t=C(e)(H(this,1),H(this,0)))===l&&_(this,0,t.e)}};function m(){return c.species||"Symbol(species)"}function y(e){return e&&"object"==typeof e}function g(e){return"function"==typeof e}function h(e,t,n){if(!t(e))throw b(n)}function v(){try{return n.apply(o,arguments)}catch(e){return l.e=e,l}}function C(e,t){return n=e,o=t,v}function P(e,t){var n=u(e),o=0;function i(){for(var i=0;i<o;)t(n[i],n[i+1]),n[i++]=void 0,n[i++]=void 0;o=0,n.length>e&&(n.length=e)}return function(e,t){n[o++]=e,n[o++]=t,2===o&&p(i)}}function T(e,t){var n,o,i,r,s=0;if(!e)throw b("Invalid argument");var a=e[c.iterator];if(g(a))o=a.call(e);else{if(!g(e.next)){if(e instanceof u){for(n=e.length;s<n;)t(e[s],s++);return s}throw b("Invalid argument")}o=e}for(;!(i=o.next()).done;)if((r=C(t)(i.value,s++))===l)throw g(o.return)&&o.return(),r.e;return s}function b(e){return new TypeError(e)}f.default=f,function(e,t){for(var n in t)e.prototype[n]=t[n]}(f,{then:function(e,t){if(void 0===this._s)throw b();return function(e,t,n,o){g(n)&&(t._onFulfilled=n);g(o)&&(e._uh&&S("rejectionHandled",e),t._onRejected=o);e[e._pCount++]=t,2!==e._s&&w(e,t);return t}(this,M((n=f,(o=this.constructor)&&o[m()]||n)),e,t);var n,o},catch:function(e){return this.then(void 0,e)},finally:function(e){return this.then((function(t){return f.resolve(e()).then((function(){return t}))}),(function(t){return f.resolve(e()).then((function(){throw t}))}))},_pCount:0,_pre:null,_Yaku:1}),f.resolve=function(e){return A(e)?e:O(M(this),e)},f.reject=function(e){return _(M(this),0,e)},f.race=function(e){var t=this,n=M(t),o=function(e){_(n,1,e)},i=function(e){_(n,0,e)},r=C(T)(e,(function(e){t.resolve(e).then(o,i)}));return r===l?t.reject(r.e):n},f.all=function(e){var t,n=this,o=M(n),i=[];function r(e){_(o,0,e)}return(t=C(T)(e,(function(e,s){n.resolve(e).then((function(e){i[s]=e,--t||_(o,1,i)}),r)})))===l?n.reject(t.e):(t||_(o,1,[]),o)},C((function(){Object.defineProperty(f,m(),{get:function(){return this}})}))(),f._Yaku=1;var w=P(999,(function(e,t){var n,o;void 0!==(o=e._s?t._onFulfilled:t._onRejected)?(n=C(I)(o,e._v))!==l?O(t,n):_(t,0,n.e):_(t,e._s,e._v)})),E=P(9,(function(e){(function e(t){if(t._umark)return!0;t._umark=!0;var n,o=0,i=t._pCount;for(;o<i;)if((n=t[o++])._onRejected||e(n))return!0})(e)||(e._uh=1,S("unhandledRejection",e))}));function S(e,t){var n="on"+e.toLowerCase(),o=r[n];a&&a.listeners(e).length?"unhandledRejection"===e?a.emit(e,t._v,t):a.emit(e,t):o&&o({reason:t._v,promise:t})}function A(e){return e&&e._Yaku}function M(e){return A(e)?new e(d):(t=new e((function(e,i){if(t)throw b();n=e,o=i})),h(n,g),h(o,g),t);var t,n,o}function H(e,t){var n=!1;return function(o){n||(n=!0,1===t?O(e,o):_(e,t,o))}}function I(e,t){return e(t)}function _(e,t,n){var o=0,i=e._pCount;if(2===e._s)for(e._s=t,e._v=n,0===t&&E(e);o<i;)w(e,e[o++]);return e}function O(e,t){if(t===e&&t)return _(e,0,b("Chaining cycle detected for promise")),e;if(null!==t&&(g(t)||y(t))){var n=C(R)(t);if(n===l)return _(e,0,n.e),e;g(n)?A(t)?U(e,t,n):p((function(){U(e,t,n)})):_(e,1,t)}else _(e,1,t);return e}function R(e){return e.then}function U(e,t,n){var o=C(n,t)((function(n){t&&(t=null,O(e,n))}),(function(n){t&&(t=null,_(e,0,n))}));o===l&&t&&(_(e,0,o.e),t=null)}try{e.exports=f}catch(e){r.Yaku=f}}()}).call(this,n(9))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.cardinalEmittedBy="3d secure",e.cardinalFailedAuthCode="N",e.cardinalSessionIdElementId="CCSessionId",e.cardinalSuccessfulErrorMessage="Success",e.cardinalProfileCompleted="profile.completed",e.consumerAuthUnavailableError="Consumer Authentication Not Available.",e.consumerAuthCanceled="Consumer Authentication Canceled",e.consumerAuthGenericError="Consumer Authentication Failed.",e.consumerAuthInvalidDataError="Consumer Authentication Invalid Data.",e.disabledClassName="disabled",e.authenticateResponseAttributeKey="AuthenticateResponse",e}();t.Constants=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.applePayHelperNotInitialized="Apple Pay helper is not initialized",e.sessionKeyNotFoundInUrl="No session key was found in the url",e.valueNotProvided="The parameter {0} was not provided and is required.",e.elementNotFound="No element was found matching selector {0}.",e}();t.Messages=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.applePayBrowserNotSupported="applePayBrowserNotSupported",e.applePayHelperCancel="applePayHelperCancel",e.applePayHelperCouldNotStartSession="applePayHelperCouldNotStartSession",e.applePayHelperNotInitialized="applePayHelperNotInitialized",e.applePayHelperSetUpSession="applePayHelperSetUpSession",e.applePayHelperUnableToCompletePayment="applePayHelperUnableToCompletePayment",e.applePayNoActiveCards="applePayNoActiveCards",e.browserOutOfDate="browserOutOfDate",e.hpcInitError="hpcInitError",e.invalidTypeText="invalidTypeText",e.maximumPaymentKeyAttempts="maximumPaymentKeyAttempts",e.networkErrorText="networkErrorText",e.paymentKeyExpiredText="paymentKeyExpiredText",e.paymentTypeInvalid="paymentTypeInvalid",e.posDataInvalidText="posDataInvalidText",e.incompleteCardNumber="incompleteCardNumber",e.incompleteExpirationDate="incompleteExpirationDate",e.incompletePostalCode="incompletePostalCode",e.incompleteSecurityCode="incompleteSecurityCode",e.invalidCardNumber="invalidCardNumber",e.invalidExpirationDate="invalidExpiration",e.invalidPostalCode="invalidPostalCode",e.invalidSecurityCode="invalidSecurityCode",e.requiredLegal="requiredLegal",e.resourceNotFound="resourceNotFound",e.resourceUnauthorized="resourceUnauthorized",e.sessionKeyInvalidText="sessionKeyInvalidText",e.sessionKeyNotFound="sessionKeyNotFound",e.storeConfigMissingGiftCardOptions="storeConfigMissingGiftCardOptions",e.storeNotConfiguredForGiftCards="storeNotConfiguredForGiftCards",e.storeNotConfiguredForPrivateLabelCards="storeNotConfiguredForPrivateLabelCards",e.unableToGeneratePaymentKeyText="unableToGeneratePaymentKeyText",e.unableToGenerateSeedText="unableToGenerateSeedText",e.unableToGetStoreConfig="unableToGetStoreConfig",e.unableToGetStoreConfigMissingStoreIdOrTerminalId="unableToGetStoreConfigMissingStoreIdOrTerminalId",e.unableToGetStoreInfo="unableToGetStoreInfo",e.unableToLoadControlsText="unableToLoadControlsText",e.unableToProcessAcknowledgeText="unableToProcessAcknowledgeText",e.unableToProcessPaymentText="unableToProcessPaymentText",e.unableToProcessRequestText="unableToProcessRequestText",e.unableToProcessReversalText="unableToProcessReversalText",e.unknownError="unknownError",e.consumerAuthFailure="consumerAuthFailure",e.consumerAuthCanceled="consumerAuthCanceled",e}();t.MessageCodes=o},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.final="final",e.pending="pending"}(t.ApplePayLineItemType||(t.ApplePayLineItemType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(t.ErrorType||(t.ErrorType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(1),r=n(2),s=n(13),a=n(14),u=n(10),l=function(){function e(){}return e.init=function(){o.WindowHelper.bindMessageEvent(window,(function(t){e.setupApplePayHelper(t),e.canInitializeApplePay(t)}))},e.isSupported=function(){return null!==this.getApplePaySession()},e.setupApplePayHelper=function(e){o.WindowHelper.logDebugMessageToConsole("ApplePay.setupApplePayHelper"),o.WindowHelper.logDebugMessageToConsole(e),e.data.type===r.EventType.SendSetupApplePayHelper&&a.ApplePayHelper.init(e.data.data.environment,e.data.data.initRequest)},e.adjustTotal=function(e){this.adjustTotalWithLineItems({amount:e,label:"Total",type:u.ApplePayLineItemType.final})},e.adjustTotalWithLineItems=function(e,t){void 0===t&&(t=[]),a.ApplePayHelper.adjustTotal(e,this.getApplePaySession(),t)},e.initialize=function(e){a.ApplePayHelper.setPaymentRequest(e)},e.canMakePayments=function(){var t=e.isSupported(),n=this.getApplePaySession();return t&&n.canMakePayments()&&n.supportsVersion(a.ApplePayHelper.applePayJsApiVersion)},e.paymentSuccessful=function(){var e=this.getApplePaySession();a.ApplePayHelper.completePayment(e.STATUS_SUCCESS)},e.paymentFailed=function(){var e=this.getApplePaySession();a.ApplePayHelper.completePayment(e.STATUS_FAILURE)},e.canInitializeApplePay=function(t){if(o.WindowHelper.logDebugMessageToConsole("canInitializeApplePay"),o.WindowHelper.logDebugMessageToConsole(t),t.data.type===r.EventType.SendApplePayIsSupported){var n=e.isSupported(),u=e.canMakePayments(),l=t.data.data;n&&u&&o.WindowHelper.bindMessageEvent(window,a.ApplePayHelper.onClick);var d=new s.ApplePayParameters;d.supported=n,d.canMakePayments=u,o.WindowHelper.sendPostMessageToIframe(new i.Message(r.EventType.ReceiveApplePayIsSupported,d),l)}},e.getApplePaySession=function(){var e=window.top;return"ApplePaySession"in e?e.ApplePaySession:null},e}();t.ApplePay=l,l.init()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){this.supported=!1,this.canMakePayments=!1};t.ApplePayParameters=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),i=n(10),r=n(15),s=n(16),a=n(2),u=n(17),l=n(4),d=n(1),c=n(20),p=n(7),f=n(21),m=n(0),y=n(3),g=function(){function e(){}return e.init=function(e,t){this.environment=e,this.setup(t),this.isInitialized=!0,this.autoFinalizePayment=t.autoFinalizePayment},e.setPaymentRequest=function(e){this.paymentRequest=e},e.onClick=function(t){if(m.WindowHelper.logDebugMessageToConsole("ApplePay.onClick"),m.WindowHelper.logDebugMessageToConsole(t),t.data.type===a.EventType.SendApplePayClick){e.assertInitialized();var n=e.paymentRequest;m.WindowHelper.logDebugMessageToConsole(n);var o=t.data.data,i=m.WindowHelper.getSessionKeyFromUrl(o);if(null===i)throw p.Messages.sessionKeyNotFoundInUrl+": "+o;var r=new window.top.ApplePaySession(e.applePayJsApiVersion,n);e.setUpSession(r,i)}},e.adjustTotal=function(t,n,o){void 0===o&&(o=[]),e.session=n,e.paymentRequest.total=t,e.paymentRequest.lineItems=o,e.session.onpaymentmethodselected=function(){e.session.completePaymentMethodSelection({newTotal:t,newLineItems:o})},e.session.onshippingcontactselected=function(){e.session.completeShippingContactSelection({newTotal:t,newLineItems:o})},e.session.onshippingmethodselected=function(){e.session.completeShippingMethodSelection({newTotal:t,newLineItems:o})}},e.setUpSession=function(t,n){m.WindowHelper.logDebugMessageToConsole("ApplePayHelper.setUpSession"),m.WindowHelper.logDebugMessageToConsole(t),e.assertInitialized(),e.sessionKey=n,e.session=t,e.session.oncancel=function(){e.showError(["Your request has been cancelled"])},e.session.onvalidatemerchant=function(t){e.validate(t.validationURL).then((function(t){m.WindowHelper.logDebugMessageToConsole("ApplePayHelper.session.onvalidatemerchant"),m.WindowHelper.logDebugMessageToConsole(t),e.session.completeMerchantValidation(t)})).catch((function(t){e.showError(["Could not start an apple pay session",t])}))},this.adjustTotal(e.paymentRequest.total,e.session,e.paymentRequest.lineItems),e.session.onpaymentauthorized=function(t){m.WindowHelper.logDebugMessageToConsole("ApplePayHelper.session.onpaymentauthorized"),m.WindowHelper.logDebugMessageToConsole(t);var n=new r.Card({cardIssuer:t.payment.token.paymentMethod.network,maskedCardNumber:t.payment.token.paymentMethod.displayName,paymentType:f.PaymentType.ApplePay,billingContact:JSON.stringify(t.payment.billingContact),shippingContact:JSON.stringify(t.payment.shippingContact)},JSON.stringify(t.payment.token.paymentData),f.PaymentType.ApplePay,y.Utilities.isNullOrUndefined(t.payment.billingContact)?null:t.payment.billingContact.postalCode);e.isActive&&(e.isActive=!1,e.onApplePayPayment(n))},e.isActive||(e.isActive=!0,e.session.begin())},e.completePayment=function(t){e.session.completePayment({status:t})},e.setup=function(e){m.WindowHelper.logDebugMessageToConsole("ApplePayHelper.setup"),m.WindowHelper.logDebugMessageToConsole(e);var t={label:"Total",amount:e.total,type:i.ApplePayLineItemType.final},n={merchantCapabilities:e.merchantCapabilities,supportedNetworks:e.supportedNetworks,countryCode:e.countryCode,requiredBillingContactFields:e.billingContactFields,requiredShippingContactFields:e.shippingContactFields,supportedCountries:[],total:t,lineItems:e.lineItems,currencyCode:e.currencyCode,shippingType:e.shippingType,shippingMethods:[]};this.setPaymentRequest(n),this.storeName=e.storeName,this.serviceBaseUrl=e.serviceBaseUrl},e.showError=function(t){if(e.isActive){e.isActive=!1;var n=[];t.forEach((function(e){n.push(new l.Error("ApplePay",e))})),c.MessageHelper.sendErrors(n,this.environment)}},e.validate=function(t){var n={uri:t,context:window.location.host,storeName:e.storeName};return m.WindowHelper.logDebugMessageToConsole("ApplePayHelper.validate"),m.WindowHelper.logDebugMessageToConsole(n),e.sendPost(e.serviceBaseUrl+"/controls/validate/apple",n)},e.onApplePayPayment=function(t){var n=this;m.WindowHelper.logDebugMessageToConsole("onApplePayPayment"),m.WindowHelper.logDebugMessageToConsole(t),e.sendPost(e.serviceBaseUrl+s.Endpoint.paymentKey,t).then((function(t){var o=t.PaymentKey?{paymentKey:t.PaymentKey,paymentType:t.paymentType}:{attributes:t.Attributes,paymentKeys:t.PaymentKeys,paymentType:t.PaymentType};n.autoFinalizePayment?e.finalize(o):m.WindowHelper.sendPostMessageToTop(new d.Message(a.EventType.ReceivePaymentKey,o),n.environment)})).catch((function(t){e.showError(["Payment could not be completed right now",t])}))},e.assertInitialized=function(){if(!e.isInitialized)throw p.Messages.applePayHelperNotInitialized},e.sendPost=function(t,n){var i={};return i.Authorization="Bearer "+e.sessionKey,new o((function(e,o){u.HttpClient.post(t,n,i).then((function(t){e(JSON.parse(t.response))})).catch((function(e){o(e)}))}))},e.finalize=function(t){if(null!==window){var n=window.top;t?(e.completePayment(n.ApplePaySession.STATUS_SUCCESS),m.WindowHelper.sendPostMessageToTop(new d.Message(a.EventType.ReceivePaymentKey,t),this.environment)):(e.completePayment(n.ApplePaySession.STATUS_FAILURE),m.WindowHelper.sendPostMessageToTop(new d.Message(a.EventType.ReceiveErrors,t),this.environment))}},e.applePayJsApiVersion=6,e}();t.ApplePayHelper=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n,o){void 0===o&&(o=null),this.attributes=e,this.cardData=t,this.paymentType=n,this.postalCode=o};t.Card=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.apmCreateOrderPayPal="/apm/create-order/paypal",e.entropy="/controls/entropy",e.paymentKey="/payments/key",e.dccCustomerDecision="/payments/dcc/decision",e.dccRate="/payments/dcc/rate",e}();t.Endpoint=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),i=n(18),r=n(19),s=n(0),a=function(){function e(){}return e.delete=function(e,t){var n=new i.HttpRequestSettings;return n.method=r.HttpVerb.Delete,n.url=e,n.headers=t,this.request(n)},e.get=function(e,t){var n=new i.HttpRequestSettings;return n.method=r.HttpVerb.Get,n.url=e,n.headers=t,this.request(n)},e.post=function(e,t,n){var o=new i.HttpRequestSettings;return o.method=r.HttpVerb.Post,o.url=e,o.data=t,o.headers=n,this.request(o)},e.put=function(e,t,n){var o=new i.HttpRequestSettings;return o.method=r.HttpVerb.Put,o.url=e,o.data=t,o.headers=n,this.request(o)},e.request=function(e){return new o((function(t,n){var o=new XMLHttpRequest;if(o.open(e.method,e.url,e.async,e.username,e.password),e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.headers&&Object.keys(e.headers).forEach((function(t){return o.setRequestHeader(t,e.headers[t])})),!e.headers||!e.headers.Authorization){var i=s.WindowHelper.getSessionKeyFromUrl();i&&o.setRequestHeader("Authorization","Bearer "+i)}o.onload=function(){200===o.status?t({response:o.response,statusText:o.statusText,xhr:o}):n({errors:o.response,status:o.status,statusText:o.statusText,xhr:o})},o.onerror=function(){n({errors:o.response,status:o.status,statusText:o.statusText,xhr:o})},e.method===r.HttpVerb.Post||e.method===r.HttpVerb.Put?(o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify(e.data))):o.send()}))},e}();t.HttpClient=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this._async=!0}return Object.defineProperty(e.prototype,"async",{get:function(){return this._async},set:function(e){this._async=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return this._headers},set:function(e){this._headers=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return this._method},set:function(e){this._method=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mimeType",{get:function(){return this._mimeType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metmimeTypehod",{set:function(e){this._mimeType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"password",{get:function(){return this._password},set:function(e){this._password=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"username",{get:function(){return this._username},set:function(e){this._username=e},enumerable:!0,configurable:!0}),e}();t.HttpRequestSettings=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Delete="DELETE",e.Get="GET",e.Post="POST",e.Put="PUT"}(t.HttpVerb||(t.HttpVerb={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=n(2),r=n(1),s=n(8),a=n(0),u=function(){function e(){}return e.sendErrors=function(e,t){var n=new r.Message(i.EventType.ReceiveErrors,{errors:e});a.WindowHelper.sendHostMessage(n,t)},e.sendFrameHeight=function(e,t){a.WindowHelper.logDebugMessageToConsole("sendFrameHeight: "+e),setTimeout((function(){var n=new r.Message(i.EventType.ReceiveFrameHeight,{height:e});a.WindowHelper.sendHostMessage(n,t)}),100)},e.sendInitError=function(e){var t=this.getMessageTranslation(s.MessageCodes.hpcInitError,"Controls did not load properly. Please refresh and try again.");this.sendErrors([new o.Error("Init",t,s.MessageCodes.hpcInitError)],e)},e.getMessageTranslation=function(e,t){if(void 0===window.hpc)return t;var n=window.hpc.messages[""+e];return void 0!==n?n:t},e}();t.MessageHelper=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Card=1]="Card",e[e.CardOnFile=2]="CardOnFile",e[e.GiftCard=3]="GiftCard",e[e.RewardCard=4]="RewardCard",e[e.GooglePay=5]="GooglePay",e[e.ApplePay=6]="ApplePay",e[e.PrivateLabelCard=7]="PrivateLabelCard",e[e.PayPal=8]="PayPal"}(t.PaymentType||(t.PaymentType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(23),i=n(6),r=n(4),s=n(2),a=n(1),u=n(8),l=n(0),d=function(){function e(){}return e.init=function(){l.WindowHelper.bindMessageEvent(window,(function(t){e.handleEvent(t)}))},e.handleEvent=function(e){var t=e.data.type;t===s.EventType.SendSetupCardinalHelper?this.setupCardinalHelper(e.data.data):t===s.EventType.SendInvokeCardinal&&this.invokeCardinal(e.data.data)},e.setupCardinalHelper=function(e){l.WindowHelper.logDebugMessageToConsole("setupCardinalHelper"),l.WindowHelper.logDebugMessageToConsole(e);var t=window.top;this.initRequest=e.initRequest;var n=this.initRequest.songbirdUrl;if(null===n){l.WindowHelper.logDebugMessageToConsole("songBirdUrl is null");var u=[];return u.push(new r.Error(i.Constants.cardinalEmittedBy,"Invalid songbird url")),void l.WindowHelper.sendPostMessageToIframe(new a.Message(s.EventType.SendCardinalErrors,u),this.initRequest.locationData)}if(void 0===t.Cardinal){var d=document.createElement("script");d.type="text/javascript",d.src=n,t.document.body.appendChild(d)}void 0===t.Cardinal?this.waitForCardinal(this.initRequest,n,0,100,2500):o.CardinalHelper.setup(this.initRequest)},e.waitForCardinal=function(e,t,n,u,d){var c=this;if(n>=d){var p=[];return l.WindowHelper.logDebugMessageToConsole("Could not load songbird after "+n+" ms"),p.push(new r.Error(i.Constants.cardinalEmittedBy,i.Constants.consumerAuthUnavailableError)),void l.WindowHelper.sendPostMessageToIframe(new a.Message(s.EventType.SendCardinalErrors,p),this.initRequest.locationData)}var f=window.top;setTimeout((function(){void 0!==f.Cardinal?o.CardinalHelper.setup(c.initRequest):(l.WindowHelper.logDebugMessageToConsole("Checking for Cardinal"),c.waitForCardinal(e,t,n+u,u,d))}),u)},e.invokeCardinal=function(e){var t=e;if(null===t.CmpiLookup||!o.CardinalHelper.isCardinalSetUp()){var n=[];return n.push(new r.Error(i.Constants.cardinalEmittedBy,i.Constants.consumerAuthGenericError,u.MessageCodes.consumerAuthFailure)),void l.WindowHelper.sendPostMessageToIframe(new a.Message(s.EventType.SendCardinalErrors,n),this.initRequest.locationData)}o.CardinalHelper.invoke(t)},e}();t.Cardinal=d,d.init()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=n(6),r=n(4),s=n(2),a=n(1),u=n(3),l=n(0),d=function(){function e(){}return e.invoke=function(e){this.processor=o.ConsumerAuthentication,this.processor.triggerBinMap(e.CmpiLookup.CardBin),this.processor.invokeCardinal(e)},e.setup=function(e){l.WindowHelper.logDebugMessageToConsole("CardinalHelper.setup"),l.WindowHelper.logDebugMessageToConsole(e),this.processor=o.ConsumerAuthentication,this.initializeProcessor(e)},e.isCardinalSetUp=function(){return!u.Utilities.isNullOrUndefined(o)&&!u.Utilities.isNullOrUndefined(o.ConsumerAuthentication)},e.initializeProcessor=function(e){l.WindowHelper.logDebugMessageToConsole("CardinalHelper.initializeProcessor"),l.WindowHelper.logDebugMessageToConsole(e);var t=window.top;this.processor.initialize({cardinal:t.Cardinal,currencyCode:e.currencyCode,jwtToken:e.cardinalCentinelJwt,maxFailureAttempts:e.maxFailureAttempts,errorCallback:function(t){var n=[];n.push(new r.Error(i.Constants.cardinalEmittedBy,t)),l.WindowHelper.sendPostMessageToIframe(new a.Message(s.EventType.SendCardinalErrors,n),e.locationData)},transactionId:e.orderNumber,tokenHeaderValue:e.tokenHeaderValue,setupCompleteCallback:function(t){l.WindowHelper.sendPostMessageToIframe(new a.Message(s.EventType.SendSetCardinalSessionId,t.sessionId),e.locationData)},successCallback:function(t){l.WindowHelper.sendPostMessageToIframe(new a.Message(s.EventType.SendCardinalApprove,t),e.locationData)},errorFloorLimit:e.errorFloorLimit,transactionTotal:e.transactionTotal,sessionKey:e.sessionKey,validatedCallback:function(t){l.WindowHelper.sendPostMessageToIframe(new a.Message(s.EventType.SendCardinalApprove,t),e.locationData)}})},e}();t.CardinalHelper=d},function(e,t,n){var o;window,o=function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./ConsumerAuthentication/Processor.ts")}({"./Common/Utilities.ts":
/*!*****************************!*\
  !*** ./Common/Utilities.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=window,i=function(){function e(){}return e.isNullOrUndefined=function(e){return null==e},e.isFunction=function(e){return"function"==typeof e},e.logToConsole=function(e){!this.isNullOrUndefined(o.console)&&o.console.log instanceof Function&&o.console.log(e)},e.assertParamDefined=function(e,t){if(this.isNullOrUndefined(e))throw t+" is required but it is "+typeof e},e.getUrlParameter=function(t,n){void 0===n&&(n=null),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=n;e.isNullOrUndefined(n)&&(o=window.location.search);var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(o);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},e}();t.Utilities=i},"./ConsumerAuthentication/Constants.ts":
/*!*********************************************!*\
  !*** ./ConsumerAuthentication/Constants.ts ***!
  \*********************************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.responses={successfulAuthentication:"Y",failedAuthentication:"N",unavailableAuthentication:"U",successfulAttemptsTransaction:"A",challengeRequiredForAuthentication:"C",authenticationRejected:"R",challengeRequired:"D",informationalOnly:"I"},e.enrolledResponse={yes:"Y",no:"N",unavailable:"U",bypass:"B"},e.signatureVerificationCodes={yes:"Y",no:"N"},e.messages={cardinalResponseInvalid:"Invalid response returned from Processor.",transactionIsAGiftCard:"The transaction should not be a gift card.",authenticationFailed:"Authentication failed. Please try again.",maxFailureAttemptsExceeded:"The maximum failure number of attempts have been completed.",emittedBy:"3d secure",genericError:"Consumer Authentication Failed.",successfulErrorMessage:"Success"},e.eventNames={paymentsComplete:"payments.setupComplete",paymentsValidated:"payments.validated"},e.actionCodes={success:"SUCCESS",noAction:"NOACTION",failure:"FAILURE",error:"ERROR"},e}();t.Constants=o},"./ConsumerAuthentication/Processor.ts":
/*!*********************************************!*\
  !*** ./ConsumerAuthentication/Processor.ts ***!
  \*********************************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(/*! ../Common/Utilities */"./Common/Utilities.ts"),i=n(/*! ./Constants */"./ConsumerAuthentication/Constants.ts"),r=n(/*! ../Models/Error */"./Models/Error.ts"),s=function(){function e(){}return e.onValidate=function(e,t,n){var s=[];if(null===e||null===e.Payment||null===e.Payment.ExtendedData||e.Payment.ExtendedData.PAResStatus!==i.Constants.messages.authenticationFailed&&e.Payment.ExtendedData.SignatureVerification!==i.Constants.messages.authenticationFailed||s.push(new r.Error(i.Constants.messages.emittedBy,i.Constants.messages.genericError)),null===e||o.Utilities.isNullOrUndefined(e.CmpiLookup)||(e.CmpiLookup.PAResStatus===i.Constants.responses.failedAuthentication&&s.push(new r.Error(i.Constants.messages.emittedBy,i.Constants.messages.genericError)),e.CmpiLookup.ErrorDesc&&s.push(new r.Error(i.Constants.messages.emittedBy,i.Constants.messages.genericError))),null!==e&&null!==e.ErrorNumber&&e.ErrorNumber>0&&e.ErrorDescription&&e.ErrorDescription!==i.Constants.messages.successfulErrorMessage&&s.push(new r.Error(i.Constants.messages.emittedBy,e.ErrorDescription)),s.length>0)return(s=[]).push(new r.Error(i.Constants.messages.emittedBy,i.Constants.messages.genericError)),n(s),void this.totalFailedAttempts++;t()},e.initialize=function(e){this.validateParameters(e),this.params=e,this.params.cardinal.configure({timeout:8e3,maxRequestTries:1,logging:{level:"Off"},payment:{view:"model",framework:"cardinal",displayLoading:!0}}),this.params.cardinal.setup("init",{jwt:this.params.jwtToken}),this.addCardinalEvent(i.Constants.eventNames.paymentsComplete,this.params.setupCompleteCallback),this.addCardinalEvent(i.Constants.eventNames.paymentsValidated,this.params.validatedCallback)},e.addCardinalEvent=function(e,t){var n=window;o.Utilities.isNullOrUndefined(n)||o.Utilities.isNullOrUndefined(n.Cardinal)||!o.Utilities.isFunction(n.Cardinal.off)||(n.Cardinal.off(e),n.Cardinal.on(e,t))},e.triggerBinMap=function(e){o.Utilities.assertParamDefined(e,"cardNumber"),this.params.cardinal.trigger("bin.process",e)},e.invokeCardinal=function(t){var n=this,r=e;return t.checkoutTransactionId=r.params.transactionId,t.requestVerificationToken=r.params.tokenHeaderValue,new Promise((function(e,s){var a=t,u=a.CmpiLookup;o.Utilities.assertParamDefined(u,"cardinalResponse.cmpiLookup");var l=u.TransactionId,d=u.PAResStatus,c="",p="",f="",m="",y="",g="";o.Utilities.isNullOrUndefined(a.Address)||(c=a.Address.Street1||"",p=a.Address.Street2||"",f=a.Address.City||"",m=a.Address.StateCode||"",y=a.Address.PostalCode||"",g=a.Address.CountryCode||"");var h={Consumer:{Email1:"",Email2:"",BillingAddress:{FirstName:"",MiddleName:"",LastName:"",Address1:c,Address2:p,Address3:"",City:f,State:m,PostalCode:y,CountryCode:g,Phone1:"",Phone2:""}},Options:{EnableCCA:!0},OrderDetails:{OrderNumber:a.TransactionId,Amount:100*a.TransactionTotal,CurrencyCode:r.params.currencyCode,OrderDescription:"HPP Transaction: "+a.TransactionId,OrderChannel:"S",TransactionId:l}};switch(o.Utilities.assertParamDefined(d,"paresStatus"),n.dataToSubmit=a,d){case i.Constants.responses.challengeRequiredForAuthentication:r.params.cardinal.continue("cca",{AcsUrl:u.ACSUrl,Payload:u.Payload,TransactionId:u.TransactionId},h,r.params.jwtToken);break;case i.Constants.responses.successfulAuthentication:case i.Constants.responses.successfulAttemptsTransaction:r.dataToSubmit.cavv=a.CmpiLookup.Cavv,r.dataToSubmit.ecom3ds=u.EciFlag,r.submitToFreeway(r.dataToSubmit);break;case i.Constants.responses.failedAuthentication:case i.Constants.responses.authenticationRejected:r.params.errorCallback(i.Constants.messages.authenticationFailed);break;case i.Constants.responses.unavailableAuthentication:r.dataToSubmit.ecom3ds=u.EciFlag,r.submitToFreeway(r.dataToSubmit);break;case"":var v=u.Enrolled;v!==i.Constants.enrolledResponse.yes||void 0!==u.Cavv&&0!==u.Cavv.length?v===i.Constants.enrolledResponse.unavailable||v===i.Constants.enrolledResponse.bypass?(r.dataToSubmit.ecom3ds=u.EciFlag,r.submitToFreeway(r.dataToSubmit)):r.submitToFreeway(r.dataToSubmit):r.params.cardinal.continue("cca",{AcsUrl:u.ACSUrl,Payload:u.Payload,TransactionId:u.TransactionId},h,r.params.jwtToken)}e()}))},e.validateParameters=function(e){o.Utilities.assertParamDefined(e.cardinal,"cardinal"),o.Utilities.assertParamDefined(e.currencyCode,"currencyCode"),o.Utilities.assertParamDefined(e.transactionId,"transactionId")},e.submitToFreeway=function(e){this.params.successCallback(e)},e.totalFailedAttempts=0,e}();t.ConsumerAuthentication=s},"./Models/Error.ts":
/*!*************************!*\
  !*** ./Models/Error.ts ***!
  \*************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){this.emittedBy=e,this.message=t};t.Error=o}})},e.exports=o()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(22);t.Cardinal=o.Cardinal;var i=n(12);t.ApplePay=i.ApplePay;var r=n(26);t.ConsumerAuth=r.ConsumerAuth},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(0),r=n(1),s=n(3),a=function(){function e(){}return e.init=function(){i.WindowHelper.bindMessageEvent(window,(function(t){e.handleEvent(t)}))},e.isConfigured=function(){return!s.Utilities.isNullOrUndefined(this.initRequest)&&!s.Utilities.isNullOrUndefined(this.initRequest.cardinalCentinelJwt)},e.handleEvent=function(e){var t=e.data;t.type===o.EventType.SendSetupCardinalHelper&&(this.initRequest=t.data.initRequest)},e.invoke=function(){if(!this.isConfigured())return i.WindowHelper.logToConsole("Consumer authentication is not configured."),["Consumer authentication is not configured."];var e=new r.Message(o.EventType.InvokeConsumerAuth);return i.WindowHelper.sendPostMessageToIframe(e,this.initRequest.locationData),null},e}();t.ConsumerAuth=a,a.init()}])}));